{% extends "root/base.html" %} {% load crispy_forms_tags %}
 {% load custom_filters %} {% block content %} {% for post in files %}
<article class="media content-section">
  <img
    class="rounded-circle article-img"
    src="{{ post.author.profile.image.url}}"
  />
  <div class="media-body">
    <div class="article-metadata">
      <small class="text-muted">{{post.created_at}}</small>
    </div>
    <h1>
      <a class="article-title" href="#">{{post.title}}</a>
    </h1>
    <a class="article-content">{{ post.file.name|basename}}</a>

    <form action="{% url 'delete_file' post.pk %}" method="POST">
      {% csrf_token %}
      {% if request.user == post.owner%}
      <button type="submit" class="btn btn-danger">Delete</button>
      <button id="favorite-button">Favorite</button>
      {% endif %}
      <a href="{% url 'download_file' post.file.path %}" class="btn btn-primary"
      >Download</a
    >
    </form>
  </div>
</article>
{% endfor %} {% for post in folders %}
<article class="media content-section">
  <div class="media-body">
    <h1>
      <a class="article-title" href="{% url 'subfolder' post.id %}"
        >{{post.name}}</a
      >
    </h1>

    {% if request.user == post.user %}
    <form action="{% url 'delete_folder' post.pk %}" method="POST">
      {% csrf_token %}
      <button type="submit" class="btn btn-danger">Delete</button>
   {%endif%}
   
    <a href="{% url 'download_folder' post.id %}" class="btn btn-primary"
    >Download</a>

  </div>
</article>
{% endfor %}

{% if folderuser == request.user %}
<h2>Create Folder</h2>
<a href="{% url 'create_folder_in_folder' parent_folder_id%}" class="btn btn-primary">Create</a>

<h2>Upload File</h2>
<a href="{% url 'create_file_in_folder' parent_folder_id%}" class="btn btn-primary">Upload</a>
{% endif %}
<!-- 
<script>
  // Assuming you have a button with id "favoriteButton" and a data attribute "fileId" containing the file ID

  // Attach a click event handler to the favorite button
  $("#favorite-Button").on("click", function () {
    // Get the file ID from the data attribute
    var fileId = $(this).data("fileId");

    // Send an AJAX POST request
    $.ajax({
      url: "/favorite/" + fileId + "/", // The URL for the favorite toggle view
      type: "POST",
      dataType: "json",
      success: function (data) {
        // Handle the success response
        // Update the button appearance based on the favorite status
        if (data.is_favorite) {
          // File is marked as favorite
          $("#favoriteButton").addClass("favorite");
        } else {
          // File is not marked as favorite
          $("#favoriteButton").removeClass("favorite");
        }
      },
      error: function (xhr, status, error) {
        // Handle the error response
        console.log(error);
      },
    });
  });
</script> -->

<!-- <script>
  $(document).ready(function () {
    $("#favorite-button").click(function () {
      $(this).toggleClass("clicked");
    });
  });
</script> -->

{% endblock content %}
